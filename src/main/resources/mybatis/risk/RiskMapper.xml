<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jsumt.mapper.risk.RiskMapper">
	<resultMap type="com.jsumt.vo.risk.ZdRiskBean" id="zdRiskBean">
		<id property="id" column="ID" />
		<result property="gcjz" column="GCJZ" />
		<result property="riskInfo" column="RISK_INFO" />
		<result property="ydcs" column="YDCS" />
		<result property="projName" column="PROJNAME" />
		<result property="type" column="TYPE" />
		<result property="isZd" column="IS_ZD" />
		<result property="zdMc" column="ZDMC" />
		<result property="zdMcNum" column="ZDMC_NUM" />
		<result property="qjFw" column="QJFW" />
		<result property="createTime" column="CREATE_TIME" />
		<result property="updateTime" column="UPDATE_TIME" />
	</resultMap>
	<!-- 根据条件查询所有事故 -->
	<select id="queryAllZdRisk" resultMap="zdRiskBean"
		parameterType="java.util.Map">
		SELECT * FROM T_AZ_TDRISK
		<where>
			<if test="projName != null and projName != '' ">
				AND PROJNAME like CONCAT('%',#{projName},'%')
			</if>
			<if test="isZd != null and isZd != '' ">
				AND IS_ZD = #{isZd}
			</if>
			<if test="type != null and type != '' ">
				AND TYPE = #{type}
			</if>
			<if test="zdMc != null and zdMc != '' ">
				AND ZDMC = #{zdMc}
			</if>
			<if test="id != null and id != '' ">
				AND ID = #{id}
			</if>
		</where>
		ORDER BY CREATE_TIME DESC
	</select>
	<insert id="addZdRisk" parameterType="com.jsumt.vo.risk.ZdRiskBean">
		INSERT INTO
		T_AZ_TDRISK(ID,GCJZ,RISK_INFO,YDCS,PROJNAME,TYPE,IS_ZD,ZDMC,ZDMC_NUM,QJFW,CREATE_TIME,UPDATE_TIME)
		VALUES(
		#{id},#{gcjz},#{riskInfo},#{ydcs},#{projName},#{type},
		#{isZd},#{zdMc},#{zdMcNum},#{qjFw},#{createTime},#{updateTime}
		)
	</insert>
	<delete id="delZdRisk" parameterType="java.util.List">
		DELETE FROM T_AZ_TDRISK
		<where>
			ID IN
			<foreach collection="list" item="id" open="(" close=")"
				separator=",">
				#{id}
			</foreach>
		</where>
	</delete>
	<update id="updateZdRisk" parameterType="java.util.Map">
		UPDATE T_AZ_TDRISK
		<set>
			<if test="gcjz != null and gcjz != '' ">
				GCJZ = #{gcjz},
			</if>
			<if test="riskInfo != null and riskInfo != '' ">
				RISK_INFO = #{riskInfo},
			</if>
			<if test="ydcs != null and ydcs != '' ">
				YDCS = #{ydcs},
			</if>
			<if test="projName != null and projName != '' ">
				PROJNAME = #{projName},
			</if>
			<if test="type != null and type != '' ">
				TYPE = #{type},
			</if>
			<if test="isZd != null and isZd != '' ">
				IS_ZD = #{isZd},
			</if>
			<if test="zdMc != null and zdMc != '' ">
				ZDMC = #{zdMc},
			</if>
			<if test="qjFw != null and qjFw != '' ">
				QJFW = #{qjFw},
			</if>
			<if test="zdMcNum != null and zdMcNum != '' ">
				ZDMC_NUM = #{zdMcNum},
			</if>
			UPDATE_TIME=now(),
		</set>
		<where>
			ID = #{id}
		</where>
	</update>
	<!-- 根据id查询一条事故的信息 -->
	<select id="queryOneById" resultMap="zdRiskBean"
		parameterType="java.lang.String">
		SELECT * FROM T_AZ_TDRISK
		<where>
			AND ID=#{id}
		</where>
	</select>

</mapper>